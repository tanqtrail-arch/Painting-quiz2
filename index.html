<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#1a1a2e">
  <title>世界の名画クイズ — Art Museum Quiz</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- ALT Badge (TRAIL連携) -->
  <div class="alt-badge" id="altBadge">
    <span class="alt-icon">🪙</span>
    <span class="alt-val" id="altDisplay">0</span>
    <span class="alt-unit">ALT</span>
  </div>

  <!-- ============================================================
       FLASH OVERLAY (correct/wrong feedback)
       ============================================================ -->
  <div id="flash-overlay" class="flash-overlay"></div>

  <!-- ============================================================
       PARTICLES CONTAINER (correct answer sparkles)
       ============================================================ -->
  <div id="particles-container" class="particles-container"></div>

  <!-- ============================================================
       CONFETTI CONTAINER (90%+ result)
       ============================================================ -->
  <div id="confetti-container" class="confetti-container"></div>

  <!-- ============================================================
       TUTORIAL OVERLAY (first-time only)
       ============================================================ -->
  <div id="tutorial-overlay" class="tutorial-overlay">
    <div class="tutorial-card">
      <div id="tutorial-emoji" class="tutorial-emoji">🎨</div>
      <h2 id="tutorial-heading" class="tutorial-heading">クイズに答えよう</h2>
      <p id="tutorial-desc" class="tutorial-desc">世界の名画を見て、作品名や作者を当てよう！</p>
      <div class="tutorial-dots">
        <span class="tutorial-dot active" data-step="0"></span>
        <span class="tutorial-dot" data-step="1"></span>
        <span class="tutorial-dot" data-step="2"></span>
      </div>
      <button id="tutorial-btn" class="tutorial-btn">次へ</button>
    </div>
  </div>

  <!-- ============================================================
       SCREEN: HOME (Quiz Start)
       ============================================================ -->
  <section id="screen-home" class="screen active">
    <!-- Title -->
    <h1 class="home-title">🖼️ 世界の名画クイズ</h1>
    <p class="home-subtitle">名画を見て答えよう！</p>

    <!-- Quiz Mode -->
    <div class="mode-selector">
      <p class="mode-selector-label">クイズモード</p>
      <div class="mode-chips" id="mode-chips">
        <button class="mode-chip active" data-mode="title">作品名</button>
        <button class="mode-chip" data-mode="artist">作者</button>
        <button class="mode-chip" data-mode="genre">ジャンル</button>
      </div>
    </div>

    <!-- Genre Filter -->
    <div class="genre-section">
      <p class="genre-section-label">ジャンル</p>
      <div class="genre-chips" id="genre-chips">
        <button class="genre-chip active" data-genre="all">すべて</button>
        <button class="genre-chip" data-genre="肖像画">肖像画</button>
        <button class="genre-chip" data-genre="風景画">風景画</button>
        <button class="genre-chip" data-genre="宗教画">宗教画</button>
        <button class="genre-chip" data-genre="歴史画">歴史画</button>
        <button class="genre-chip" data-genre="静物画">静物画</button>
        <button class="genre-chip" data-genre="風俗画">風俗画</button>
        <button class="genre-chip" data-genre="浮世絵">浮世絵</button>
        <button class="genre-chip" data-genre="抽象画">抽象画</button>
        <button class="genre-chip" data-genre="神話画">神話画</button>
      </div>
    </div>

    <!-- Difficulty -->
    <div class="difficulty-section">
      <p class="difficulty-section-label">難易度</p>
      <div class="difficulty-cards" id="difficulty-cards">
        <button class="difficulty-card active" data-difficulty="1">
          <span class="stars">⭐</span>
          <span class="diff-label">かんたん</span>
          <span class="diff-desc">3択</span>
        </button>
        <button class="difficulty-card" data-difficulty="2">
          <span class="stars">⭐⭐</span>
          <span class="diff-label">ふつう</span>
          <span class="diff-desc">4択</span>
        </button>
        <button class="difficulty-card" data-difficulty="3">
          <span class="stars">⭐⭐⭐</span>
          <span class="diff-label">むずかしい</span>
          <span class="diff-desc">4択</span>
        </button>
      </div>
    </div>

    <!-- Start Button -->
    <button id="btn-start" class="btn-start">クイズスタート！</button>
  </section>

  <!-- ============================================================
       SCREEN: QUIZ
       ============================================================ -->
  <section id="screen-quiz" class="screen">
    <!-- Progress -->
    <div class="quiz-progress">
      <span id="quiz-progress-text" class="quiz-progress-text">1 / 10</span>
      <div class="quiz-progress-bar">
        <div id="quiz-progress-fill" class="quiz-progress-fill" style="width: 10%"></div>
      </div>
      <span id="quiz-score" class="quiz-score">0問正解</span>
    </div>

    <!-- Painting -->
    <div class="quiz-painting" id="quiz-painting">
      <div class="painting-loader">
        <div class="spinner"></div>
      </div>
      <img id="quiz-painting-img" src="" alt="名画">
      <!-- Streak Badge -->
      <div id="streak-badge" class="streak-badge"></div>
    </div>

    <!-- Feedback -->
    <div id="quiz-feedback" class="quiz-feedback"></div>

    <!-- Choices -->
    <div id="quiz-choices" class="quiz-choices">
      <!-- Choice buttons are generated dynamically by quiz.js -->
    </div>

    <!-- Next Button -->
    <button id="btn-next" class="btn-next">次の問題へ</button>
  </section>

  <!-- ============================================================
       SCREEN: RESULT
       ============================================================ -->
  <section id="screen-result" class="screen">
    <div id="result-medal" class="result-medal"></div>
    <h2 class="result-title">クイズ終了！</h2>
    <div id="result-score" class="result-score">0%</div>
    <p class="result-score-label">正解率</p>

    <div class="result-stats">
      <div class="result-stat">
        <div id="result-correct" class="stat-value green">0</div>
        <div class="stat-label">正解</div>
      </div>
      <div class="result-stat">
        <div id="result-wrong" class="stat-value red">0</div>
        <div class="stat-label">不正解</div>
      </div>
    </div>

    <!-- Correct Paintings Thumbnails -->
    <div class="result-paintings">
      <p class="result-paintings-title">正解した作品</p>
      <div id="result-paintings-grid" class="result-paintings-grid">
        <!-- Filled dynamically -->
      </div>
    </div>

    <!-- Actions -->
    <div class="result-actions">
      <button id="btn-retry" class="btn-retry">もう一回チャレンジ</button>
      <button id="btn-result-home" class="btn-home">ホームに戻る</button>
    </div>
  </section>

  <!-- ============================================================
       SCREEN: COLLECTION (図鑑)
       ============================================================ -->
  <section id="screen-collection" class="screen">
    <!-- Header -->
    <div class="collection-header">
      <h2 class="collection-title">📖 コレクション</h2>
      <span id="collection-count" class="collection-count">0 / 100</span>
    </div>

    <!-- Progress -->
    <div class="collection-progress-bar">
      <div id="collection-progress-fill" class="collection-progress-fill" style="width: 0%"></div>
    </div>

    <!-- Genre Filters -->
    <div class="collection-filters" id="collection-filters">
      <button class="filter-chip active" data-genre="all">すべて</button>
      <button class="filter-chip" data-genre="肖像画">肖像画</button>
      <button class="filter-chip" data-genre="風景画">風景画</button>
      <button class="filter-chip" data-genre="宗教画">宗教画</button>
      <button class="filter-chip" data-genre="歴史画">歴史画</button>
      <button class="filter-chip" data-genre="静物画">静物画</button>
      <button class="filter-chip" data-genre="風俗画">風俗画</button>
      <button class="filter-chip" data-genre="浮世絵">浮世絵</button>
      <button class="filter-chip" data-genre="抽象画">抽象画</button>
      <button class="filter-chip" data-genre="神話画">神話画</button>
    </div>

    <!-- Grid -->
    <div id="collection-grid" class="collection-grid">
      <!-- Collection cards generated by collection.js -->
      <!-- Example card structure:
      <div class="collection-card locked" data-id="1">
        <img class="collection-card-img" src="..." alt="...">
        <span class="lock-icon">🔒</span>
        <div class="collection-card-info">
          <div class="collection-card-title">モナ・リザ</div>
          <div class="collection-card-artist">レオナルド・ダ・ヴィンチ</div>
        </div>
      </div>
      -->
    </div>
  </section>

  <!-- ============================================================
       SCREEN: SETTINGS
       ============================================================ -->
  <section id="screen-settings" class="screen">
    <h2 class="settings-title">⚙️ 設定</h2>

    <div class="settings-group">
      <div class="settings-item">
        <span class="settings-item-label">効果音</span>
        <div id="toggle-sound" class="toggle on" role="switch" aria-checked="true"></div>
      </div>
      <div class="settings-item">
        <span class="settings-item-label">アニメーション</span>
        <div id="toggle-animation" class="toggle on" role="switch" aria-checked="true"></div>
      </div>
    </div>

    <div class="settings-group">
      <div class="settings-item">
        <span class="settings-item-label">出題数</span>
        <span id="settings-question-count" class="settings-item-value">10問</span>
      </div>
    </div>

    <div class="settings-danger">
      <button id="btn-reset-data" class="btn-danger">コレクションをリセット</button>
    </div>

    <p class="settings-version">Painting Quiz v2.0.0</p>
  </section>

  <!-- ============================================================
       MODAL: Detail (作品詳細)
       ============================================================ -->
  <div id="screen-detail-modal">
    <div class="modal-content">
      <div class="modal-handle"></div>
      <img id="modal-painting" class="modal-painting" src="" alt="作品画像">
      <div class="modal-info">
        <h3 id="modal-title" class="modal-title"></h3>
        <p id="modal-artist" class="modal-artist"></p>
        <div class="modal-meta">
          <span id="modal-year" class="modal-meta-item">📅 <span></span></span>
          <span id="modal-museum" class="modal-meta-item">🏛️ <span></span></span>
        </div>
        <div class="modal-trivia">
          <p class="modal-trivia-label">豆知識</p>
          <p id="modal-trivia-text"></p>
        </div>
        <a id="modal-wiki-link" class="modal-wiki-link" href="#" target="_blank" rel="noopener noreferrer">
          📚 もっと知りたい → Wikipedia
        </a>
      </div>
      <button id="modal-close-btn" class="modal-close-btn">とじる</button>
    </div>
  </div>

  <!-- ============================================================
       TAB BAR — Bottom Navigation
       ============================================================ -->
  <nav id="tab-bar">
    <button class="tab-item active" data-screen="screen-home">
      <span class="tab-icon">🎨</span>
      <span class="tab-label">クイズ</span>
    </button>
    <button class="tab-item" data-screen="screen-collection">
      <span class="tab-icon">📖</span>
      <span class="tab-label">コレクション</span>
    </button>
    <button class="tab-item" data-screen="screen-settings">
      <span class="tab-icon">⚙️</span>
      <span class="tab-label">設定</span>
    </button>
  </nav>

  <!-- ============================================================
       SCRIPTS
       ============================================================ -->
  <script src="js/data-loader.js"></script>
  <script src="js/app.js"></script>
  <script src="js/quiz.js"></script>
  <script src="js/collection.js"></script>

  <!-- TrailNav v2 連携 -->
  <script src="trail-nav.js"></script>
  <script>
    if (typeof TrailNav !== 'undefined') {
      TrailNav.init({
        gameName: '絵画クイズ',
        gameId: 'Painting-quiz2',
        gameEmoji: '🖼️',
        gameHomeId: 'screen-home',
        tgp32Url: 'https://trail-game-pro-3-2.onrender.com',
        apiBase: 'https://trail-game-pro-3-2.onrender.com/api',
      });
    }
  </script>

</body>
</html>
